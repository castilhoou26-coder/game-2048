<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>2048 Game</title>
<style>
    body { font-family: sans-serif; display: flex; justify-content: center; align-items: center; height: 100vh; background: #faf8ef; margin: 0; }
    #game { display: grid; grid-template-columns: repeat(4, 80px); grid-gap: 10px; }
    .tile { width: 80px; height: 80px; display: flex; justify-content: center; align-items: center; font-size: 24px; font-weight: bold; border-radius: 5px; color: #776e65; }
    .tile-0 { background: #cdc1b4; }
    .tile-2 { background: #eee4da; }
    .tile-4 { background: #ede0c8; }
    .tile-8 { background: #f2b179; color: #f9f6f2; }
    .tile-16 { background: #f59563; color: #f9f6f2; }
    .tile-32 { background: #f67c5f; color: #f9f6f2; }
    .tile-64 { background: #f65e3b; color: #f9f6f2; }
    .tile-128 { background: #edcf72; color: #f9f6f2; }
    .tile-256 { background: #edcc61; color: #f9f6f2; }
    .tile-512 { background: #edc850; color: #f9f6f2; }
    .tile-1024 { background: #edc53f; color: #f9f6f2; }
    .tile-2048 { background: #edc22e; color: #f9f6f2; }
</style>
</head>
<body>

<div id="game"></div>

<script>
let tabuleiro = [
    [0,0,0,0],
    [0,0,0,0],
    [0,0,0,0],
    [0,0,0,0]
];

function addNumero() {
    let vazios = [];
    for (let i = 0; i < 4; i++) {
        for (let j = 0; j < 4; j++) {
            if (tabuleiro[i][j] === 0) vazios.push([i,j]);
        }
    }
    if (vazios.length > 0) {
        let [i,j] = vazios[Math.floor(Math.random() * vazios.length)];
        tabuleiro[i][j] = Math.random() < 0.9 ? 2 : 4;
    }
}

function render() {
    const gameDiv = document.getElementById('game');
    gameDiv.innerHTML = '';
    for (let i = 0; i < 4; i++) {
        for (let j = 0; j < 4; j++) {
            const tile = document.createElement('div');
            tile.className = 'tile tile-' + tabuleiro[i][j];
            tile.textContent = tabuleiro[i][j] === 0 ? '' : tabuleiro[i][j];
            gameDiv.appendChild(tile);
        }
    }
}

function moverEsquerda() {
    for (let i = 0; i < 4; i++) {
        let linha = tabuleiro[i].filter(n => n !== 0);
        for (let j = 0; j < linha.length-1; j++) {
            if (linha[j] === linha[j+1]) {
                linha[j] *= 2;
                linha[j+1] = 0;
            }
        }
        linha = linha.filter(n => n !== 0);
        while (linha.length < 4) linha.push(0);
        tabuleiro[i] = linha;
    }
}

function moverDireita() {
    for (let i = 0; i < 4; i++) {
        tabuleiro[i].reverse();
        moverEsquerda();
        tabuleiro[i].reverse();
    }
}

function transpor() {
    tabuleiro = tabuleiro[0].map((_, i) => tabuleiro.map(linha => linha[i]));
}

function moverCima() {
    transpor();
    moverEsquerda();
    transpor();
}

function moverBaixo() {
    transpor();
    moverDireita();
    transpor();
}

function checkGameOver() {
    for (let i=0;i<4;i++){
        for (let j=0;j<4;j++){
            if(tabuleiro[i][j] === 2048) alert("ðŸŽ‰ PARABÃ‰NS! VocÃª chegou a 2048!");
        }
    }
}

document.addEventListener('keydown', (e) => {
    let moved = false;
    switch(e.key) {
        case 'ArrowLeft': moverEsquerda(); moved = true; break;
        case 'ArrowRight': moverDireita(); moved = true; break;
        case 'ArrowUp': moverCima(); moved = true; break;
        case 'ArrowDown': moverBaixo(); moved = true; break;
        default: return;
    }
    if(moved) { addNumero(); render(); checkGameOver(); }
});

// Swipe para celular
let touchStartX = 0;
let touchStartY = 0;

document.addEventListener('touchstart', function(e) {
    touchStartX = e.changedTouches[0].screenX;
    touchStartY = e.changedTouches[0].screenY;
}, false);

document.addEventListener('touchend', function(e) {
    let touchEndX = e.changedTouches[0].screenX;
    let touchEndY = e.changedTouches[0].screenY;
    let dx = touchEndX - touchStartX;
    let dy = touchEndY - touchStartY;

    if(Math.abs(dx) > Math.abs(dy)) {
        if(dx > 30) { moverDireita(); }
        else if(dx < -30) { moverEsquerda(); }
        else return;
    } else {
        if(dy > 30) { moverBaixo(); }
        else if(dy < -30) { moverCima(); }
        else return;
    }
    addNumero(); render(); checkGameOver();
}, false);

addNumero();
addNumero();
render();
</script>

</body>
</html>
